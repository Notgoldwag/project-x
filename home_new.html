<!-- -->
<!DOCTYPE html>
<html lang="en" class="light">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Text Editor with AI Assistant (Modern)</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>

  <!-- Fonts: Inter (UI) + Source Code Pro (editor) + Orbitron (Prompt Playground title) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Code+Pro:wght@400;500;600&family=Orbitron:wght@700;900&display=swap"
    rel="stylesheet">

  <!-- Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Chart.js for metrics visualization -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
  
  <!-- Markdown rendering -->
  <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>

  <link rel="stylesheet" href="static/css/home.css">

  <!-- Background Animation Styles -->
  <link href="static/css/bg.css" rel="stylesheet" />

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#00cba0",
            primaryDarker: "#009e7a",
            "background-light": "#0b0f14",
            "background-dark": "#07090d",
          },
          fontFamily: {
            display: ["Inter", "ui-sans-serif", "system-ui", "Segoe UI", "Helvetica", "Arial", "sans-serif"],
            mono: ["Source Code Pro", "ui-monospace", "SFMono-Regular", "Menlo", "Consolas", "monospace"],
          },
          borderRadius: {
            DEFAULT: "12px",
            '2xl': '20px',
            '3xl': '24px',
          },
          boxShadow: {
            floating: '0 6px 20px rgba(0, 0, 0, 0.12), 0 1px 3px rgba(0, 0, 0, 0.08)',
            'floating-dark': '0 8px 28px rgba(0, 0, 0, 0.55), 0 1px 3px rgba(0, 0, 0, 0.35)',
            outline: '0 0 0 1px rgba(255,255,255,0.06) inset',
          }
        },
      },
    };
  </script>

  <style>
    /* ---------- Fluid background (subtler gradient + soft dimming) ---------- */
    .fluid-bg {
      position: fixed;
      inset: 0;
      z-index: -1;
      overflow: hidden;
      pointer-events: none;
      filter: saturate(102%) contrast(101%);
      animation: hue 28s linear infinite;
      opacity: 0.85;
      /* soft dimming */
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .blob {
      position: absolute;
      border-radius: 50%;
      filter: blur(55px);
      opacity: .28;
      mix-blend-mode: screen;
    }

    .blob.one {
      width: 42vw;
      height: 42vw;
      background: radial-gradient(circle at 30% 30%, #00cba0, transparent 60%);
      left: -10vw;
      top: -10vh;
      animation: float1 26s ease-in-out infinite;
    }

    .blob.two {
      width: 36vw;
      height: 36vw;
      background: radial-gradient(circle at 70% 40%, #38bdf8, transparent 60%);
      right: -8vw;
      top: 10vh;
      animation: float2 24s ease-in-out infinite;
    }

    .blob.three {
      width: 44vw;
      height: 44vw;
      background: radial-gradient(circle at 40% 60%, #00cba0, transparent 60%);
      left: 10vw;
      bottom: -12vh;
      animation: float3 28s ease-in-out infinite;
    }

    .grain {
      position: absolute;
      inset: -200%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' opacity='0.05'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
      animation: drift 55s linear infinite;
      mix-blend-mode: soft-light;
    }

    /* ---------- Left-side dimmer to tone down gradients near History ---------- */
    .left-dimmer {
      position: fixed;
      z-index: 0;
      top: 0;
      left: 0;
      bottom: 0;
      width: min(32vw, 560px);
      background: linear-gradient(to right, rgba(7, 9, 13, 0.65) 0%, rgba(7, 9, 13, 0.48) 35%, rgba(7, 9, 13, 0.28) 60%, transparent 85%);
      pointer-events: none;
    }

    @keyframes float1 {

      0%,
      100% {
        transform: translate(0, 0) scale(1)
      }

      50% {
        transform: translate(6vw, 4vh) scale(1.06)
      }
    }

    @keyframes float2 {

      0%,
      100% {
        transform: translate(0, 0) scale(1)
      }

      50% {
        transform: translate(-5vw, 3vh) scale(0.97)
      }
    }

    @keyframes float3 {

      0%,
      100% {
        transform: translate(0, 0) scale(1)
      }

      50% {
        transform: translate(4vw, -4vh) scale(1.03)
      }
    }

    @keyframes hue {
      from {
        filter: saturate(102%) contrast(101%) hue-rotate(0deg)
      }

      to {
        filter: saturate(102%) contrast(101%) hue-rotate(10deg)
      }
    }

    @keyframes drift {
      from {
        transform: translate3d(0, 0, 0)
      }

      to {
        transform: translate3d(-25%, -25%, 0)
      }
    }

    /* ---------- Acrylic (frosted glass) utility ---------- */
    .acrylic {
      background: rgba(17, 19, 24, 0.45);
      -webkit-backdrop-filter: blur(14px) saturate(120%);
      backdrop-filter: blur(14px) saturate(120%);
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.45);
    }

    /* Left sidebar - slightly darker */
    .acrylic--sidebar {
      background: rgba(17, 19, 24, 0.55);
      -webkit-backdrop-filter: blur(14px) saturate(115%) brightness(0.95);
      backdrop-filter: blur(14px) saturate(115%) brightness(0.95);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.50);
    }

    /* History panel - slightly cooler and lighter */
    .acrylic--history {
      background: rgba(17, 19, 24, 0.40);
      -webkit-backdrop-filter: blur(14px) saturate(110%) brightness(1.05);
      backdrop-filter: blur(14px) saturate(110%) brightness(1.05);
      border: 1px solid rgba(255, 255, 255, 0.07);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.40);
    }

    /* Text editor - neutral baseline */
    .acrylic--editor {
      background: rgba(17, 19, 24, 0.45);
      -webkit-backdrop-filter: blur(14px) saturate(120%);
      backdrop-filter: blur(14px) saturate(120%);
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.45);
    }

    /* AI assistant - slightly warmer with higher contrast */
    .acrylic--assistant {
      background: rgba(17, 19, 24, 0.38);
      -webkit-backdrop-filter: blur(14px) saturate(125%) contrast(1.05);
      backdrop-filter: blur(14px) saturate(125%) contrast(1.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.42);
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px
    }

    ::-webkit-scrollbar-track {
      background: #111318
    }

    ::-webkit-scrollbar-thumb {
      background: #3a3f4a;
      border-radius: 4px
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555d6b
    }

    * {
      scrollbar-width: thin;
      scrollbar-color: #3a3f4a #111318
    }

    /* Icons */
    .material-icons {
      font-size: 18px;
      vertical-align: middle
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fadeIn 0.4s ease-out forwards;
    }

    @keyframes gradient-x {

      0%,
      100% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }
    }

    .animate-gradient-x {
      background-size: 200% 200%;
      animation: gradient-x 3s ease infinite;
    }

    /* ---------- Compact editor tweaks ---------- */
    .editor-area {
      line-height: 1.6;
      tab-size: 2;
      caret-color: #00cba0;
      font-variant-ligatures: contextual;
      overflow: auto;
      /* Enable both horizontal and vertical scrolling */
      word-wrap: break-word;
      /* Break long words if needed */
      white-space: pre-wrap;
      /* Preserve whitespace and allow wrapping */
    }

    /* Custom scrollbar styling for editor areas */
    .editor-area::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    .editor-area::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .editor-area::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    .editor-area::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .editor-area::-webkit-scrollbar-corner {
      background: rgba(255, 255, 255, 0.05);
    }

    /* IMPORTANT: make the editor fill the panel height */
    .editor-container {
      display: flex;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      overflow: auto;
      /* Allow both horizontal and vertical scrolling while containing content */
      background: rgba(255, 255, 255, 0.02);
      height: 100%;
      /* NEW */
    }

    /* Custom scrollbar styling for editor containers */
    .editor-container::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    .editor-container::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 3px;
    }

    .editor-container::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
    }

    .editor-container::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .editor-container::-webkit-scrollbar-corner {
      background: rgba(255, 255, 255, 0.05);
    }

    .line-numbers {
      background: rgba(255, 255, 255, 0.03);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      padding: 12px 6px;
      font-family: "Source Code Pro", monospace;
      font-size: 14px;
      line-height: 1.6;
      color: #6b7280;
      user-select: none;
      min-width: 45px;
      text-align: center;
      overflow: hidden;
      height: 100%;
      /* CHANGED from max-height to height */
    }

    .editor-wrapper {
      flex: 1;
      position: relative;
      height: 100%;
      /* NEW */
      display: flex;
      /* NEW: lets textarea stretch */
      flex-direction: column;
      /* NEW */
    }

    .toolbar-btn {
      width: 34px;
      height: 34px
    }

    .segmented>button:not(:last-child) {
      border-right: 1px solid rgba(255, 255, 255, 0.06)
    }

    .sticky-toolbar {
      position: sticky;
      top: 0;
      z-index: 10;
      -webkit-backdrop-filter: blur(10px) saturate(120%);
      backdrop-filter: blur(10px) saturate(120%);
      background: rgba(8, 10, 13, 0.35);
    }

    /* ---------- Cursor glow ---------- */
    #cursor-glow {
      position: fixed;
      left: 0;
      top: 0;
      width: 300px;
      height: 300px;
      margin-left: 0;
      margin-top: 0;
      border-radius: 50%;
      pointer-events: none;
      transform: translate(-50%, -50%);
      filter: blur(67px);
      mix-blend-mode: screen;
      background: radial-gradient(circle, rgba(0, 203, 160, 0.18) 0%, rgba(0, 203, 160, 0.09) 42%, rgba(0, 0, 0, 0) 70%);
      opacity: 0.8;
      transition: opacity 200ms ease;
      z-index: 2;
    }

    @media (prefers-reduced-motion: reduce) {

      .blob,
      .grain {
        animation: none !important;
      }

      #cursor-glow {
        transition: none !important;
      }
    }

    /* History item lime acrylic effect */
    [data-selected="true"] {
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      background: rgba(0, 204, 160, 0.10) !important;
      border: 1px solid rgba(0, 204, 160, 0.30) !important;
      box-shadow: inset 0 0 0 1px rgba(0, 204, 160, 0.15);
    }

    [data-selected="true"]:hover {
      background: rgba(0, 204, 160, 0.15) !important;
    }

    [data-selected="true"]:active {
      background: rgba(0, 204, 160, 0.20) !important;
    }

    [data-selected="true"]:focus-visible {
      outline: none;
      box-shadow: 0 0 0 2px rgba(0, 204, 160, 0.40);
    }

    /* Line clamp utilities for text truncation */
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .line-clamp-1 {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    /* Chat Assistant Specific Styles */
    #chat-transcript {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
    }

    #chat-transcript::-webkit-scrollbar {
      width: 8px;
    }

    #chat-transcript::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    #chat-transcript::-webkit-scrollbar-thumb {
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    #chat-transcript::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255, 255, 255, 0.3);
    }

    /* Message animations */
    .message-user,
    .message-ai {
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Jump to latest button */
    #jump-to-latest {
      animation: slideInFromBottom 0.3s ease-out;
    }

    @keyframes slideInFromBottom {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    #jump-to-latest.fade-out {
      animation: fadeOut 0.2s ease-out forwards;
    }

    @keyframes fadeOut {
      from {
        opacity: 1;
        transform: translateY(0);
      }

      to {
        opacity: 0;
        transform: translateY(10px);
      }
    }

    /* Textarea auto-resize transition */
    #message-input {
      transition: height 0.2s ease-out;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    /* Typing indicator animation */
    @keyframes typingPulse {

      0%,
      60%,
      100% {
        opacity: 0.4;
      }

      30% {
        opacity: 1;
      }
    }

    .animate-pulse {
      animation: typingPulse 1.4s infinite;
    }

    /* Bouncing dots animation */
    @keyframes bounce {

      0%,
      80%,
      100% {
        transform: translateY(0) scale(1);
      }

      40% {
        transform: translateY(-8px) scale(1.1);
      }
    }

    .animate-bounce-dot {
      animation: bounce 1.2s ease-in-out infinite;
    }

    /* Typing indicator container bounce */
    @keyframes typingBounce {

      0%,
      100% {
        transform: translateY(0);
      }

      25% {
        transform: translateY(-3px);
      }

      50% {
        transform: translateY(0);
      }

      75% {
        transform: translateY(-2px);
      }
    }

    .typing-container-bounce {
      animation: typingBounce 2s ease-in-out infinite;
    }

    /* Glow pulse for AI icon during typing */
    @keyframes glowPulse {

      0%,
      100% {
        box-shadow: 0 0 10px rgba(42, 247, 173, 0.3);
      }

      50% {
        box-shadow: 0 0 20px rgba(42, 247, 173, 0.6), 0 0 30px rgba(42, 247, 173, 0.3);
      }
    }

    .ai-icon-glow {
      animation: glowPulse 1.5s ease-in-out infinite;
    }

    /* Error toast animation */
    #error-toast {
      animation: slideInFromTop 0.3s ease-out;
    }

    #new-messages-notification {
      animation: slideInFromTop 0.3s ease-out;
    }

    @keyframes slideInFromTop {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Focus states */
    #message-input:focus {
      outline: none;
    }

    /* Disabled button styles */
    #send-button:disabled {
      cursor: not-allowed;
    }

    #send-button:disabled:hover {
      transform: none !important;
    }

    /* Smooth scrolling */
    #chat-transcript {
      scroll-behavior: smooth;
    }

    /* Message content word wrapping */
    .message-content {
      word-wrap: break-word;
      overflow-wrap: break-word;
      max-width: 100%;
    }

    /* Responsive scroll height */
    @media (max-height: 600px) {
      #chat-transcript {
        max-height: calc(100vh - 220px) !important;
      }
    }

    @media (min-height: 800px) {
      #chat-transcript {
        max-height: calc(100vh - 320px) !important;
      }
    }

    /* Custom Markdown Formatting for Formatted Editor */
    #formattedEditor {
      font-family: 'Inter', system-ui, sans-serif;
      line-height: 1.7;
      overflow: auto;
      /* Enable both horizontal and vertical scrolling */
      white-space: normal;
      /* Allow normal text wrapping for paragraphs */
      word-wrap: break-word;
      /* Break long words if needed */
      overflow-wrap: break-word;
      /* Modern CSS property for word breaking */
    }

    /* Custom scrollbar styling for formatted editor */
    #formattedEditor::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    #formattedEditor::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    #formattedEditor::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    #formattedEditor::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    #formattedEditor::-webkit-scrollbar-corner {
      background: rgba(255, 255, 255, 0.05);
    }

    #formattedEditor h1,
    #formattedEditor h2,
    #formattedEditor h3,
    #formattedEditor h4,
    #formattedEditor h5,
    #formattedEditor h6 {
      color: #ffffff;
      font-weight: 700;
      margin-top: 1.5em;
      margin-bottom: 0.5em;
      line-height: 1.3;
    }

    #formattedEditor h1 {
      font-size: 1.75rem;
      border-bottom: 2px solid #00cba0;
      padding-bottom: 0.25rem;
    }

    #formattedEditor h2 {
      font-size: 1.5rem;
    }

    #formattedEditor h3 {
      font-size: 1.25rem;
      color: #00cba0;
    }

    #formattedEditor h4 {
      font-size: 1.1rem;
    }

    #formattedEditor p {
      color: #e2e8f0;
      margin-bottom: 1em;
    }

    #formattedEditor strong {
      color: #ffffff;
      font-weight: 600;
    }

    #formattedEditor em {
      color: #cbd5e1;
      font-style: italic;
    }

    #formattedEditor ul,
    #formattedEditor ol {
      margin-bottom: 1em;
      padding-left: 1.5rem;
    }

    #formattedEditor li {
      color: #e2e8f0;
      margin-bottom: 0.25em;
    }

    #formattedEditor blockquote {
      border-left: 4px solid #00cba0;
      margin: 1.5em 0;
      padding: 0.5em 1em;
      background: rgba(255, 255, 255, 0.02);
      color: #cbd5e1;
      font-style: italic;
    }

    #formattedEditor code {
      background: rgba(255, 255, 255, 0.1);
      color: #00cba0;
      padding: 0.125rem 0.25rem;
      border-radius: 0.25rem;
      font-family: 'Source Code Pro', monospace;
      font-size: 0.9em;
    }

    #formattedEditor pre {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 0.5rem;
      padding: 1rem;
      margin: 1em 0;
      overflow-x: auto;
      /* Horizontal scroll for long code lines */
      white-space: pre;
      /* Preserve formatting and prevent wrapping */
    }

    #formattedEditor pre code {
      background: none;
      padding: 0;
      color: #e2e8f0;
    }

    #formattedEditor a {
      color: #00cba0;
      text-decoration: none;
      border-bottom: 1px solid transparent;
      transition: border-bottom-color 0.2s;
    }

    #formattedEditor a:hover {
      border-bottom-color: #00cba0;
    }

    #formattedEditor table {
      width: 100%;
      margin: 1em 0;
      border-collapse: collapse;
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: block;
      /* Allow table to be scrollable */
      overflow-x: auto;
      /* Horizontal scroll for wide tables */
      white-space: nowrap;
      /* Prevent cell content from wrapping */
    }

    #formattedEditor th,
    #formattedEditor td {
      padding: 0.75rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: left;
    }

    #formattedEditor th {
      background: rgba(255, 255, 255, 0.05);
      color: #ffffff;
      font-weight: 600;
    }

    #formattedEditor td {
      color: #e2e8f0;
    }

    #formattedEditor hr {
      border: none;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      margin: 2rem 0;
    }

    /* Formatted Editor Styles for Markdown Content */
    #formattedEditor {
      font-size: 16px;
      line-height: 1.7;
      color: #e2e8f0;
    }

    #formattedEditor h1 {
      font-size: 2.25rem;
      font-weight: 800;
      color: #ffffff;
      margin: 2rem 0 1rem 0;
      border-bottom: 2px solid rgba(0, 203, 160, 0.3);
      padding-bottom: 0.5rem;
    }

    #formattedEditor h2 {
      font-size: 1.875rem;
      font-weight: 700;
      color: #ffffff;
      margin: 1.75rem 0 0.75rem 0;
    }

    #formattedEditor h3 {
      font-size: 1.5rem;
      font-weight: 600;
      color: #ffffff;
      margin: 1.5rem 0 0.5rem 0;
    }

    #formattedEditor h4, 
    #formattedEditor h5, 
    #formattedEditor h6 {
      font-weight: 600;
      color: #ffffff;
      margin: 1.25rem 0 0.5rem 0;
    }

    #formattedEditor p {
      margin: 1rem 0;
      color: #e2e8f0;
    }

    #formattedEditor strong {
      font-weight: 600;
      color: #ffffff;
    }

    #formattedEditor em {
      font-style: italic;
      color: #f1f5f9;
    }

    #formattedEditor ul, 
    #formattedEditor ol {
      margin: 1rem 0;
      padding-left: 1.5rem;
      color: #e2e8f0;
    }

    #formattedEditor li {
      margin: 0.5rem 0;
    }

    #formattedEditor blockquote {
      border-left: 4px solid #00cba0;
      background: rgba(0, 203, 160, 0.1);
      margin: 1.5rem 0;
      padding: 1rem 1.5rem;
      font-style: italic;
      color: #f8fafc;
    }

    #formattedEditor pre {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 0.75rem;
      padding: 1.5rem;
      overflow-x: auto;
      margin: 1.5rem 0;
      font-family: "Source Code Pro", monospace;
    }

    #formattedEditor code {
      background: rgba(0, 0, 0, 0.3);
      color: #00cba0;
      padding: 0.25rem 0.5rem;
      border-radius: 0.375rem;
      font-family: "Source Code Pro", monospace;
      font-size: 0.875rem;
    }

    #formattedEditor pre code {
      background: transparent;
      padding: 0;
      color: #e2e8f0;
    }

    #formattedEditor table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 0.5rem;
      overflow: hidden;
    }

    #formattedEditor th,
    #formattedEditor td {
      padding: 0.75rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: left;
    }

    #formattedEditor th {
      background: rgba(0, 203, 160, 0.1);
      color: #ffffff;
      font-weight: 600;
    }

    #formattedEditor td {
      color: #e2e8f0;
    }

    #formattedEditor hr {
      border: none;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      margin: 2rem 0;
    }

    #formattedEditor a {
      color: #00cba0;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s ease;
    }

    #formattedEditor a:hover {
      color: #009e7a;
      text-decoration: underline;
    }

    /* Scrollbar styling for formatted editor */
    #formatted-editor-container::-webkit-scrollbar {
      width: 8px;
    }

    #formatted-editor-container::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    #formatted-editor-container::-webkit-scrollbar-thumb {
      background: rgba(0, 203, 160, 0.3);
      border-radius: 4px;
    }

    #formatted-editor-container::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 203, 160, 0.5);
    }

    /* Editor Actions Styling */
    .editor-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .icon-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      border: none;
      background: none;
      cursor: pointer;
      border-radius: 0.5rem;
      transition: all 0.2s ease;
    }

    .icon-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: #00cba0;
    }

    .icon-btn:focus {
      outline: 2px solid rgba(0, 203, 160, 0.5);
      outline-offset: 2px;
    }

    .icon-btn:active {
      transform: scale(0.95);
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      background: rgba(0, 203, 160, 0.9);
      color: white;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      z-index: 1000;
      transform: translateY(100%);
      opacity: 0;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }
  </style>
</head>

<body
  class="bg-background-light dark:bg-background-dark font-display text-gray-200 antialiased transition-colors duration-500 selection:bg-primary/30 selection:text-white">

  <!-- Auth Loading Overlay -->
  <div id="auth-loading" class="fixed inset-0 bg-background-dark z-50 flex items-center justify-center">
    <div class="text-center">
      <div class="w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
      <p class="text-gray-400">Checking authentication...</p>
    </div>
  </div>

  <!-- Main Content (hidden until auth is verified) -->
  <div id="main-content" class="hidden">

    <!-- React TypeScript Background Animation -->
